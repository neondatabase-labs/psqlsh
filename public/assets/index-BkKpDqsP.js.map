{"version":3,"file":"index-BkKpDqsP.js","sources":["../../../node_modules/@segment/analytics-next/dist/pkg/core/query-string/pickPrefix.js","../../../node_modules/@segment/analytics-next/dist/pkg/core/query-string/index.js"],"sourcesContent":["/**\n * Returns an object containing only the properties prefixed by the input\n * string.\n * Ex: prefix('ajs_traits_', { ajs_traits_address: '123 St' })\n * will return { address: '123 St' }\n **/\nexport function pickPrefix(prefix, object) {\n    return Object.keys(object).reduce(function (acc, key) {\n        if (key.startsWith(prefix)) {\n            var field = key.substr(prefix.length);\n            acc[field] = object[key];\n        }\n        return acc;\n    }, {});\n}\n//# sourceMappingURL=pickPrefix.js.map","import { pickPrefix } from './pickPrefix';\nimport { gracefulDecodeURIComponent } from './gracefulDecodeURIComponent';\nimport { isPlainObject } from '@segment/analytics-core';\nexport function queryString(analytics, query) {\n    var a = document.createElement('a');\n    a.href = query;\n    var parsed = a.search.slice(1);\n    var params = parsed.split('&').reduce(function (acc, str) {\n        var _a = str.split('='), k = _a[0], v = _a[1];\n        acc[k] = gracefulDecodeURIComponent(v);\n        return acc;\n    }, {});\n    var calls = [];\n    var ajs_uid = params.ajs_uid, ajs_event = params.ajs_event, ajs_aid = params.ajs_aid;\n    var _a = isPlainObject(analytics.options.useQueryString)\n        ? analytics.options.useQueryString\n        : {}, _b = _a.aid, aidPattern = _b === void 0 ? /.+/ : _b, _c = _a.uid, uidPattern = _c === void 0 ? /.+/ : _c;\n    if (ajs_aid) {\n        var anonId = Array.isArray(params.ajs_aid)\n            ? params.ajs_aid[0]\n            : params.ajs_aid;\n        if (aidPattern.test(anonId)) {\n            analytics.setAnonymousId(anonId);\n        }\n    }\n    if (ajs_uid) {\n        var uid = Array.isArray(params.ajs_uid)\n            ? params.ajs_uid[0]\n            : params.ajs_uid;\n        if (uidPattern.test(uid)) {\n            var traits = pickPrefix('ajs_trait_', params);\n            calls.push(analytics.identify(uid, traits));\n        }\n    }\n    if (ajs_event) {\n        var event_1 = Array.isArray(params.ajs_event)\n            ? params.ajs_event[0]\n            : params.ajs_event;\n        var props = pickPrefix('ajs_prop_', params);\n        calls.push(analytics.track(event_1, props));\n    }\n    return Promise.all(calls);\n}\n//# sourceMappingURL=index.js.map"],"names":["pickPrefix","prefix","object","acc","key","field","queryString","analytics","query","a","parsed","params","str","_a","k","v","gracefulDecodeURIComponent","calls","ajs_uid","ajs_event","ajs_aid","isPlainObject","_b","aidPattern","_c","uidPattern","anonId","uid","traits","event_1","props"],"mappings":"wWAMO,SAASA,EAAWC,EAAQC,EAAQ,CACvC,OAAO,OAAO,KAAKA,CAAM,EAAE,OAAO,SAAUC,EAAKC,EAAK,CAClD,GAAIA,EAAI,WAAWH,CAAM,EAAG,CACxB,IAAII,EAAQD,EAAI,OAAOH,EAAO,MAAM,EACpCE,EAAIE,CAAK,EAAIH,EAAOE,CAAG,CAC1B,CACD,OAAOD,CACV,EAAE,CAAE,CAAA,CACT,CCXO,SAASG,EAAYC,EAAWC,EAAO,CAC1C,IAAIC,EAAI,SAAS,cAAc,GAAG,EAClCA,EAAE,KAAOD,EACT,IAAIE,EAASD,EAAE,OAAO,MAAM,CAAC,EACzBE,EAASD,EAAO,MAAM,GAAG,EAAE,OAAO,SAAUP,EAAKS,EAAK,CACtD,IAAIC,EAAKD,EAAI,MAAM,GAAG,EAAGE,EAAID,EAAG,CAAC,EAAGE,EAAIF,EAAG,CAAC,EAC5C,OAAAV,EAAIW,CAAC,EAAIE,EAA2BD,CAAC,EAC9BZ,CACV,EAAE,CAAE,CAAA,EACDc,EAAQ,CAAA,EACRC,EAAUP,EAAO,QAASQ,EAAYR,EAAO,UAAWS,EAAUT,EAAO,QACzEE,EAAKQ,EAAcd,EAAU,QAAQ,cAAc,EACjDA,EAAU,QAAQ,eAClB,CAAE,EAAEe,EAAKT,EAAG,IAAKU,EAAaD,IAAO,OAAS,KAAOA,EAAIE,EAAKX,EAAG,IAAKY,EAAaD,IAAO,OAAS,KAAOA,EAChH,GAAIJ,EAAS,CACT,IAAIM,EAAS,MAAM,QAAQf,EAAO,OAAO,EACnCA,EAAO,QAAQ,CAAC,EAChBA,EAAO,QACTY,EAAW,KAAKG,CAAM,GACtBnB,EAAU,eAAemB,CAAM,CAEtC,CACD,GAAIR,EAAS,CACT,IAAIS,EAAM,MAAM,QAAQhB,EAAO,OAAO,EAChCA,EAAO,QAAQ,CAAC,EAChBA,EAAO,QACb,GAAIc,EAAW,KAAKE,CAAG,EAAG,CACtB,IAAIC,EAAS5B,EAAW,aAAcW,CAAM,EAC5CM,EAAM,KAAKV,EAAU,SAASoB,EAAKC,CAAM,CAAC,CAC7C,CACJ,CACD,GAAIT,EAAW,CACX,IAAIU,EAAU,MAAM,QAAQlB,EAAO,SAAS,EACtCA,EAAO,UAAU,CAAC,EAClBA,EAAO,UACTmB,EAAQ9B,EAAW,YAAaW,CAAM,EAC1CM,EAAM,KAAKV,EAAU,MAAMsB,EAASC,CAAK,CAAC,CAC7C,CACD,OAAO,QAAQ,IAAIb,CAAK,CAC5B","x_google_ignoreList":[0,1]}